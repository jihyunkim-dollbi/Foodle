<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.mapper.weekly-mapper">
	<resultMap type="MaininfoVO" id="maininfoMap">
  	<result column="rno" property="rNo"/>
  	<result column="rname" property="rName"/>
  	<result column="rtype" property="rType"/>
  	<result column="rscore" property="rScore"/>
  	<result column="rscorecount" property="rScoreCount"/>
  	<result column="rarea" property="rArea"/>
  	<result column="raddr1" property="rAddr1"/>
  	<result column="rtel" property="rTel"/>
  	<result column="iname" property="ivo.iName"/>
  	<result column="ilink" property="ivo.iLink"/>
  	<result column="ropentime" property="rvo.rOpentime"/>
  	<result column="rclosetime" property="rvo.rClosetime"/>
  </resultMap>
  
  <select id="weeklyListData" resultMap="maininfoMap" parameterType="java.util.Map">
    SELECT rno,rname,rtype,rscore,rscorecount,rarea,raddr1,rtel,ilink,ropentime,rclosetime,num 
    FROM (SELECT rno,rname,rtype,rscore,rscorecount,rarea,raddr1,rtel,ilink,ropentime,rclosetime,rownum as num 
    FROM (SELECT maininfo.rno,rname,rtype,rscore,rscorecount,rarea,raddr1,rtel,ilink,ropentime,rclosetime 
    FROM maininfo,image,reserveinfo
    WHERE maininfo.rno=image.rno
    AND maininfo.rno=reserveinfo.rno
    AND image.iname LIKE 'Mainimage'
    ORDER BY maininfo.rno ASC))
    WHERE num BETWEEN #{start} AND #{end}
  </select>
  
  <select id="weeklyTotalPage" resultType="int">
  	SELECT CEIL(COUNT(*)/18.0) FROM maininfo
  </select>
</mapper>